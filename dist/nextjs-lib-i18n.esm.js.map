{"version":3,"file":"nextjs-lib-i18n.esm.js","sources":["../src/utils.ts","../src/resource.ts","../src/provider.tsx","../src/middleware.ts","../src/link.tsx"],"sourcesContent":["import URI from 'urijs';\r\nimport type { ValidLocale } from './type';\r\n\r\nexport const getNormalizeTralingSlashPath = (\r\n  path: string,\r\n  removeTralingSlash = true\r\n) => {\r\n  const uri = new URI(path);\r\n  if (uri.path().endsWith('/')) {\r\n    return removeTralingSlash ? uri.directory() : uri.path();\r\n  } else {\r\n    return removeTralingSlash ? uri.path() : uri.path() + '/';\r\n  }\r\n};\r\n\r\nexport const getAllViableLocaleRegex = (locale: string) => {\r\n  const [language, region] = locale.split('-');\r\n  // here we support checking capitalized and trailing slash\r\n  // valid example: /en-us  /en-US /EN-US /EN-us /en-us/\r\n  return new RegExp(\r\n    `^/(${language}|${language.toUpperCase()})-(${region}|${region.toUpperCase()})(\\/?)`\r\n  );\r\n};\r\n\r\nexport const getMatchLocaleByPath = <T extends { [x: string]: ValidLocale }>(\r\n  path: string,\r\n  supportedLocales: T\r\n) => {\r\n  return Object.values(supportedLocales).find((locale) => {\r\n    return getAllViableLocaleRegex(locale).test(path);\r\n  });\r\n};\r\n\r\nexport const getLocaleOmmitedPath = <T extends { [x: string]: ValidLocale }>(\r\n  path: string,\r\n  supportedLocales: T\r\n) => {\r\n  const locale = getMatchLocaleByPath(path, supportedLocales);\r\n  if (locale) {\r\n    return path.replace(getAllViableLocaleRegex(locale), '/');\r\n  } else {\r\n    return path;\r\n  }\r\n};\r\n\r\nexport const getLocaleOmmitedUrl = <T extends { [x: string]: ValidLocale }>(\r\n  url: string,\r\n  supportedLocales: T\r\n) => {\r\n  const uri = new URI(url);\r\n  const newUri = uri.pathname(\r\n    getLocaleOmmitedPath(uri.pathname(), supportedLocales)\r\n  );\r\n  return newUri.readable();\r\n};\r\n","import i18next from 'i18next';\r\nimport {\r\n  getLocaleOmmitedPath,\r\n  getMatchLocaleByPath,\r\n  getNormalizeTralingSlashPath,\r\n} from './utils';\r\nimport { initReactI18next } from 'react-i18next';\r\nimport { useRouter } from 'next/router';\r\nimport { useTranslation } from 'react-i18next';\r\nimport type { StringMap, TOptions } from 'i18next';\r\nimport type { ValidLocale } from './type';\r\n\r\nconst ResourceSymbol = Symbol('i18nextResource');\r\n\r\ntype IResource<\r\n  T extends object,\r\n  SupportedLocale extends { [lang: string]: ValidLocale },\r\n  KeyOfSupportedLocale extends keyof SupportedLocale\r\n> = {\r\n  [lng in SupportedLocale[KeyOfSupportedLocale]]?: T;\r\n} & {\r\n  [ResourceSymbol]?: string;\r\n};\r\n\r\ntype TFunction<T extends object> = <\r\n  K extends keyof T,\r\n  TResult = T[K],\r\n  TInterpolationMap extends object = StringMap\r\n>(\r\n  key: K,\r\n  options?: TOptions<TInterpolationMap> | string\r\n) => TResult;\r\n\r\nexport class I18Next<\r\n  SupportedLocale extends { [lang: string]: ValidLocale },\r\n  KeyOfSupportedLocale extends keyof SupportedLocale,\r\n  LocaleCode extends SupportedLocale[KeyOfSupportedLocale]\r\n> {\r\n  private nsCounter = 0;\r\n\r\n  private constructor(\r\n    public supportedLocales: SupportedLocale,\r\n    public deafultLocale: LocaleCode\r\n  ) {\r\n    i18next.use(initReactI18next).init({\r\n      resources: { [deafultLocale]: {} },\r\n      lng: deafultLocale,\r\n      supportedLngs: Object.values(supportedLocales),\r\n      partialBundledLanguages: true,\r\n      lowerCaseLng: true,\r\n      fallbackLng: Object.values(supportedLocales),\r\n      interpolation: { escapeValue: false },\r\n    });\r\n  }\r\n\r\n  static init<\r\n    SupportedLocale extends { [lang: string]: ValidLocale },\r\n    KeyOfSupportedLocale extends keyof SupportedLocale,\r\n    LocaleCode extends SupportedLocale[KeyOfSupportedLocale]\r\n  >(options: { supportedLocales: SupportedLocale; defaultLocale: LocaleCode }) {\r\n    return new I18Next(options.supportedLocales, options.defaultLocale);\r\n  }\r\n\r\n  useChangeLocale = () => {\r\n    const router = useRouter();\r\n    const handleChange = <K extends keyof SupportedLocale>(\r\n      locale: SupportedLocale[K]\r\n    ) => {\r\n      const localeOmmitedPath = getLocaleOmmitedPath(\r\n        router.asPath,\r\n        this.supportedLocales\r\n      );\r\n      const as = `/${locale}${localeOmmitedPath}`;\r\n      router.push(router.pathname, as);\r\n    };\r\n    return handleChange;\r\n  };\r\n\r\n  useCurrentLanguage = () => {\r\n    return i18next.language;\r\n  };\r\n\r\n  useLocaleCanonicalPath = (\r\n    { reserveDefaultLocalePath } = { reserveDefaultLocalePath: false }\r\n  ) => {\r\n    const router = useRouter();\r\n    const currentLanguage = this.useCurrentLanguage();\r\n    let path: string;\r\n    if (currentLanguage === this.deafultLocale && !reserveDefaultLocalePath) {\r\n      path = getLocaleOmmitedPath(router.asPath, this.supportedLocales);\r\n    } else {\r\n      if (!getMatchLocaleByPath(router.asPath, this.supportedLocales)) {\r\n        path = `/${currentLanguage}${router.asPath}`;\r\n      } else {\r\n        path = router.asPath;\r\n      }\r\n    }\r\n    return getNormalizeTralingSlashPath(path);\r\n  };\r\n\r\n  useResource = <T extends object>(\r\n    resource: IResource<T, SupportedLocale, keyof SupportedLocale>\r\n  ) => {\r\n    if (!resource[ResourceSymbol])\r\n      throw Error('Resource must be created using createResource function');\r\n    const lng = this.useCurrentLanguage();\r\n    const useTranslationFn = useTranslation(resource[ResourceSymbol]).t;\r\n    const t = (field: string, options: object) =>\r\n      useTranslationFn(field, Object.assign({}, { ...options }, { lng }));\r\n    return { t } as { t: TFunction<T> };\r\n  };\r\n\r\n  createResource = <T extends object>(\r\n    resource: IResource<T, SupportedLocale, keyof SupportedLocale>\r\n  ) => {\r\n    resource[ResourceSymbol] = (this.nsCounter++).toString();\r\n    Object.entries(resource).forEach(([lng, keyValue]) => {\r\n      if (!i18next.hasResourceBundle(lng, resource[ResourceSymbol]!)) {\r\n        i18next.addResourceBundle(\r\n          lng,\r\n          resource[ResourceSymbol]!,\r\n          keyValue,\r\n          true,\r\n          true\r\n        );\r\n      }\r\n    });\r\n    return resource;\r\n  };\r\n}\r\n","import i18next from 'i18next';\r\nimport React from 'react';\r\nimport { getMatchLocaleByPath } from './utils';\r\nimport { useRouter } from 'next/router';\r\nimport type { NextPageContext } from 'next';\r\nimport type { ValidLocale } from './type';\r\nimport type { I18Next } from './resource';\r\n\r\nconst isServer = typeof window === 'undefined';\r\n\r\nconst localeContext = {\r\n  locale: '' as ValidLocale,\r\n  i18n: (null as unknown) as I18Next<any, any, any>,\r\n};\r\n\r\nexport const LocaleContext = React.createContext<{\r\n  locale: ValidLocale;\r\n  i18n: I18Next<any, any, any>;\r\n}>(localeContext);\r\n\r\nexport const _LocaleProvider = LocaleContext.Provider;\r\n\r\nexport const getLocaleFromAppContext = (\r\n  ctx: NextPageContext,\r\n  defaultLocale: string\r\n) => {\r\n  const headers = ctx.req ? ctx.req.headers : { locale: defaultLocale };\r\n  const { locale } = headers;\r\n  return locale?.toString() ?? defaultLocale;\r\n};\r\n\r\nexport const LocaleProvider: React.FC<{\r\n  initialLocale: ValidLocale;\r\n  i18n: I18Next<any, any, any>;\r\n}> = ({ initialLocale, children, i18n }) => {\r\n  const router = useRouter();\r\n  const locale = React.useMemo(() => {\r\n    // server's router.asPath has been ommited in locale middleware\r\n    if (isServer) return initialLocale;\r\n    // we detect client side locale from router.asPath\r\n    else\r\n      return (\r\n        getMatchLocaleByPath(router.asPath, i18n.supportedLocales) ??\r\n        initialLocale\r\n      );\r\n  }, [router]);\r\n  i18next.language = locale;\r\n  return <_LocaleProvider value={{ locale, i18n }}>{children}</_LocaleProvider>;\r\n};\r\n","import { getLocaleOmmitedUrl, getMatchLocaleByPath } from './utils';\r\nimport type express from 'express';\r\nimport type { ValidLocale } from './type';\r\n\r\nexport const localeParser = ({\r\n  supportedLocales,\r\n  defaultLocale,\r\n}: {\r\n  supportedLocales: { [lang: string]: ValidLocale };\r\n  defaultLocale: ValidLocale;\r\n}) => (\r\n  req: express.Request,\r\n  _: express.Response,\r\n  next: express.NextFunction\r\n) => {\r\n  req.headers = Object.assign({}, req.headers, { locale: defaultLocale }); // assign default language\r\n  try {\r\n    const matchedLocale = getMatchLocaleByPath(req.path, supportedLocales);\r\n    if (matchedLocale) {\r\n      req.headers = Object.assign({}, req.headers, { locale: matchedLocale });\r\n      req.url = getLocaleOmmitedUrl(req.url, supportedLocales);\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n  } finally {\r\n    next();\r\n  }\r\n};\r\n","import _Link from 'next/link';\r\nimport React from 'react';\r\nimport { LocaleContext } from './provider';\r\nimport type { LinkProps } from 'next/link';\r\n\r\nexport const Link: React.FC<LinkProps> = ({\r\n  children,\r\n  href,\r\n  as: originAs,\r\n  ...rest\r\n}) => {\r\n  const localeContext = React.useContext(LocaleContext);\r\n  const i18n = localeContext.i18n;\r\n  const currentLanguage = i18n.useCurrentLanguage();\r\n  const as =\r\n    currentLanguage === i18n.deafultLocale\r\n      ? originAs ?? href\r\n      : `/${currentLanguage}${originAs ?? href}`;\r\n  return (\r\n    <_Link href={href} as={as} {...rest}>\r\n      {children}\r\n    </_Link>\r\n  );\r\n};\r\n"],"names":["getNormalizeTralingSlashPath","path","removeTralingSlash","uri","URI","endsWith","directory","getAllViableLocaleRegex","locale","split","language","region","RegExp","toUpperCase","getMatchLocaleByPath","supportedLocales","Object","values","find","test","getLocaleOmmitedPath","replace","getLocaleOmmitedUrl","url","newUri","pathname","readable","ResourceSymbol","Symbol","I18Next","deafultLocale","router","useRouter","handleChange","localeOmmitedPath","asPath","as","push","i18next","reserveDefaultLocalePath","currentLanguage","useCurrentLanguage","resource","Error","lng","useTranslationFn","useTranslation","t","field","options","assign","nsCounter","toString","entries","forEach","keyValue","hasResourceBundle","addResourceBundle","use","initReactI18next","init","resources","supportedLngs","partialBundledLanguages","lowerCaseLng","fallbackLng","interpolation","escapeValue","defaultLocale","isServer","window","localeContext","i18n","LocaleContext","React","createContext","_LocaleProvider","Provider","getLocaleFromAppContext","ctx","headers","req","LocaleProvider","initialLocale","children","useMemo","value","localeParser","_","next","matchedLocale","e","console","error","Link","href","originAs","rest","useContext","_Link"],"mappings":"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"}